<div class="p-2" *ngIf="messageViewModel"
     [ngClass]="{'unread-message':  ((!message.read && !message.sender.person && !person && message.sender.person.id == person.id) || !message.read) && !onlyContent}">

  <div class="d-flex flex-row" *ngIf="message.content.discriminator == 'MESSAGE_CONTENT'; else systemMessageContent">
    <div class="d-flex flex-row">
      <app-image *ngIf="!onlyContent" [type]="'LOGO'"
                 [clazz]="'PERSON'"
                 [id]="message.sender.person.id"
                 [dimension]="'W40xH40'"
                 [format]="'CIRCLE'"></app-image>
      <div class="d-flex flex-column ml-2">
        <div *ngIf="!onlyContent" class="d-flex flex-row align-content-center">
          <a class="link" routerLink="/person/{{message.sender.person.id}}">{{message.sender.person.firstName}}</a>
          <p class="date ml-2">{{message.content.created | date:'dd.MM.yyyy HH:mm'}}</p>
        </div>
        <div *ngIf="messageViewModel.body" [innerHTML]="messageViewModel.body | urlParser"
             (click)="onDataClick($event)"></div>
      </div>
    </div>
  </div>

  <ng-template #systemMessageContent>
    <div class="d-flex flex-row">
      <div class="d-flex flex-column">
        <p *ngIf="!onlyContent" class="date">{{message.content.created | date:'dd.MM.yyyy HH:mm'}}</p>
        <div *ngIf="messageViewModel.body" class="system-message"
             [innerHTML]="messageViewModel.body | urlParser" (click)="onDataClick($event)"></div>
      </div>
    </div>
  </ng-template>

</div>
