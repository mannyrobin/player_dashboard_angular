<div class="d-flex w-100 p-2" [routerLink]="conversation.id">

  <app-image
    #logo
    *ngIf="conversation"
    [type]="'LOGO'"
    [clazz]="conversationImageClazz"
    [id]="conversationImageId"
    [dimension]="'W80xH80'"
    [format]="'CIRCLE'"></app-image>

  <div class="d-flex flex-column w-100 ml-2">
    <div class="d-flex">
      <p class="name">{{conversationName}}</p>
      <p class="date ml-auto" *ngIf="!conversationWrapper.messageWrapper.empty">
        {{conversationWrapper.messageWrapper.message.created |
        date:'dd.MM.yyyy HH:mm'}}</p>
    </div>

    <div class="d-flex flex-row align-items-center p-2"
         [ngClass]="{'unread-message': !conversationWrapper.messageWrapper.empty && !conversationWrapper.messageWrapper.message.read}">

      <div *ngIf="conversationWrapper.typingParticipants.length; else message"
           class="text-typing">
        <div *ngIf="conversationWrapper.typingParticipants.length == 1;else multiTyping">
          {{conversationWrapper.typingParticipants[0].person.firstName}} {{'isTypingAMessage' | translate |
          lowercase}}
        </div>
        <ng-template #multiTyping>
          <div *ngFor="let item of conversationWrapper.typingParticipants">
            {{item.person.firstName}},
          </div>
          {{'areTypingMessages' | translate | lowercase}}
        </ng-template>
      </div>

      <ng-template #message>
        <div
          *ngIf="!conversationWrapper.messageWrapper.empty && conversationWrapper.messageWrapper.message.content.discriminator == 'MESSAGE_CONTENT' && senderPerson"
          class="mr-2">
          <app-image [type]="'LOGO'"
                     [clazz]="'PERSON'"
                     [id]="senderPerson.id"
                     [dimension]="'W40xH40'"
                     [format]="'CIRCLE'"></app-image>
        </div>
        <div class="message" *ngIf="!conversationWrapper.messageWrapper.empty">
          <app-message [message]="conversationWrapper.messageWrapper.message" [onlyContent]="true"></app-message>
        </div>
      </ng-template>

      <div *ngIf="conversationWrapper.messageWrapper.unread" class="ml-auto">
        <span class="badge badge-primary p-1 ml-2">{{conversationWrapper.messageWrapper.unread}}</span>
      </div>

    </div>


  </div>
</div>
