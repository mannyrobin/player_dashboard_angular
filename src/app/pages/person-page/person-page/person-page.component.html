<div *ngIf="person">
  <!-- person info -->
  <div class="d-flex flex-row">
    <div class="d-flex flex-column">
      <div class="img img-fluid avatar"
           [ngStyle]="{'background-image': 'url('+ logo +')'}">
      </div>
      <button *ngIf="isEditAllow"
              class="btn btn-default btn-file btn-sm mt-2">
        <i class="fa fa-pencil-square-o"></i>
        <span> {{'persons.person.changeAvatar' | translate | uppercase}}
            <input type="file"
                   (change)="onLogoChange($event)"
                   accept="image/*">
          </span>
      </button>
    </div>
    <div class="d-flex flex-column ml-4">
      <div class="d-flex flex-row h-100">
        <div class="align-self-center">
          <h3>{{person.firstName | uppercase}}</h3>
          <h3>{{person.lastName | uppercase}}</h3>
          <h3>{{person.patronymic | uppercase}}</h3>
          <br>
          <p>{{'persons.person.rating' | translate | uppercase}}: 100</p>
        </div>
      </div>
    </div>
  </div>

  <!-- roles -->
  <div class="d-flex flex-row mt-5">
    <div class="align-self-center">
      <p>{{'persons.person.roles.section' | translate | uppercase}}</p>
    </div>
    <div class="ml-2 align-self-center">
      <div class="btn-group"
           ngbRadioGroup
           name="radioBasic"
           [(ngModel)]="roleToggle"
           (change)="onRoleChange()">
        <label ngbButtonLabel
               class="btn-primary"
               *ngFor="let role of userRoles">
          <input ngbButton
                 type="radio"
                 [value]="role">{{role.userRoleEnum}}
        </label>
      </div>
    </div>
    <div *ngIf="isEditAllow"
         class="ml-2 align-self-center">
      <button class="btn btn-default btn-sm"
              (click)="toggleRolesModal()">
        <i class="fa fa-pencil-square-o"></i>
        <span> {{'persons.person.edit' | translate | uppercase}}</span>
      </button>
    </div>
  </div>

  <!-- sport types -->
  <div class="d-flex flex-row mt-2">
    <div class="align-self-center">
      <p>{{'persons.person.sportTypes.section' | translate | uppercase}}</p>
    </div>
    <div class="ml-2 align-self-center ">
      <div class="btn-group"
           ngbRadioGroup
           name="radioBasic"
           [(ngModel)]="sportTypeToggle"
           (change)="onSportTypeChange()">
        <label ngbButtonLabel
               class="btn-primary"
               *ngFor="let sportType of personSportTypes">
          <input ngbButton
                 type="radio"
                 [value]="sportType">{{sportType.sportTypeEnum}}
        </label>
      </div>
    </div>
    <div *ngIf="isEditAllow"
         class="ml-2 align-self-center">
      <button class="btn btn-default btn-sm"
              (click)="toggleSportTypesModal()">
        <i class="fa fa-pencil-square-o"></i>
        <span> {{'persons.person.edit' | translate | uppercase}}</span>
      </button>
    </div>
  </div>

  <!-- tabs -->
  <div class="mt-3">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link" routerLink="personal" [ngClass]="{'active' : router.url.indexOf('personal') > -1}">
          {{'persons.person.personal.section' | translate | uppercase }}
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" routerLink="anthropometry" [ngClass]="{'active' : router.url.indexOf('anthropometry') > -1}"
           *ngIf="roleToggle !== undefined && roleToggle.userRoleEnum.toString() !== 'TRAINER'">
          {{'persons.person.anthropometry.section' | translate | uppercase }}
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" routerLink="physiology" [ngClass]="{'active' : router.url.indexOf('physiology') > -1}"
           *ngIf="roleToggle !== undefined && roleToggle.userRoleEnum.toString() !== 'TRAINER'">
          {{'persons.person.physiology.section' | translate | uppercase }}
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" routerLink="contact" [ngClass]="{'active' : router.url.indexOf('contact') > -1}">
          {{'persons.person.contact.section' | translate | uppercase }}
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" routerLink="tests_results" [ngClass]="{'active' : router.url.indexOf('tests_results') > -1}"
           *ngIf="roleToggle !== undefined && roleToggle.userRoleEnum.toString() !== 'TRAINER'">
          {{'persons.person.testsResults.section' | translate | uppercase }}
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" routerLink="events" [ngClass]="{'active' : router.url.indexOf('events') > -1}"
           *ngIf="roleToggle !== undefined && roleToggle.userRoleEnum.toString() !== 'TRAINER'">
          {{'persons.person.events.section' | translate | uppercase }}
        </a>
      </li>
    </ul>
  </div>

  <router-outlet></router-outlet>

  <dx-popup
    class="popup"
    [width]="600"
    [height]="500"
    [showTitle]="true"
    title="{{'persons.person.roles.section' | translate}}"
    [dragEnabled]="false"
    [closeOnOutsideClick]="true"
    [(visible)]="rolesModal">
    <div *dxTemplate="let data of 'content'" class="p-0">
      <div class="row h-100 ">
        <div class="col-6">
          <app-input-search *ngIf="roles"
                            [search]="getRoles"
                            [dblclick]="addRole"
                            [notify]="roleSubject"
                            [key]="'userRoleEnum'">
          </app-input-search>
        </div>
        <div class="col-6 ">
          <div class="user-roles">
            <ul *ngFor="let role of userRolesModal">
              <li class="item">
                <button class="btn btn-primary btn-xs" (click)="removeRole(role)">
                  <i class="fa fa-times"></i><span>{{role.userRoleEnum}}</span>
                </button>
              </li>
            </ul>
            <button class="btn btn-sm" (click)="changeRoles()">Save</button>
          </div>
        </div>
      </div>
    </div>
  </dx-popup>
  <dx-popup
    class="popup"
    [width]="600"
    [height]="500"
    [showTitle]="true"
    title="{{'persons.person.sportTypes.edit' | translate}}"
    [dragEnabled]="false"
    [closeOnOutsideClick]="true"
    [(visible)]="sportTypesModal">
    <div *dxTemplate="let data of 'content'" class="p-0">
      <div class="row h-100 ">
        <div class="col-6">
          <app-input-search *ngIf="sportTypes"
                            [search]="getSportTypes"
                            [dblclick]="addSportType"
                            [notify]="sportTypeSubject"
                            [key]="'sportTypeEnum'">
          </app-input-search>
        </div>
        <div class="col-6 ">
          <div class="user-roles">
            <ul *ngFor="let sportType of personSportTypesModal">
              <li class="item">
                <button class="btn btn-primary btn-xs" (click)="removeSportType(sportType)">
                  <i class="fa fa-times"></i><span>{{sportType.sportTypeEnum}}</span>
                </button>
              </li>
            </ul>
            <button class="btn btn-sm" (click)="changeSportTypes()">Save</button>
          </div>
        </div>
      </div>
    </div>
  </dx-popup>
</div>
