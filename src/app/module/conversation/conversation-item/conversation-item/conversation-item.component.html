<button mat-button class="contact"
        (click)="openConversation()" [ngClass]="{'unread':conversationWrapper.messageWrapper.unread}"
        [@animate]="{value:'*',params:{y:'100%'}}">

  <div fxLayout="row" fxLayoutAlign="start center" class="d-flex">

    <div class="avatar-wrapper" fxFlex="0 1 auto" fxLayoutAlign="center center">
      <app-image #logo
                 class="avatar"
                 [type]="'LOGO'"
                 [clazz]="conversationImageClazz"
                 [id]="conversationImageId"
                 [dimension]="'W40xH40'"
                 [format]="'CIRCLE'"></app-image>
    </div>

    <div fxLayout="row" fxFlex>

      <div class="pr-4" fxFlex fxLayout="column" fxLayoutAlign="center start">
        <div class="contact-name">{{conversationName}}</div>

        <div *ngIf="conversationWrapper.typingParticipants.length; else messageContent"
             class="contact-last-message">
          <div *ngIf="conversationWrapper.typingParticipants.length == 1;else multiTyping">
            {{conversationWrapper.typingParticipants[0].person.firstName}} {{'isTypingAMessage' | translate |
            lowercase}}
          </div>
          <ng-template #multiTyping>
            <div *ngFor="let item of conversationWrapper.typingParticipants">
              {{item.person.firstName}},
            </div>
            {{'areTypingMessages' | translate | lowercase}}
          </ng-template>
        </div>
        <ng-template #messageContent>
          <div class="contact-last-message">
            <app-preview-message-item [message]="conversationWrapper.messageWrapper.message"></app-preview-message-item>
          </div>
        </ng-template>

      </div>

      <div fxLayout="column" fxLayoutAlign="start end">
        <div class="contact-last-message-time">
          {{updated ? (('edited' | translate | lowercase) + ' ' + (updated | date:'dd.MM.yyyy HH:mm') )
          : (conversationWrapper.messageWrapper.message.created | date:'dd.MM.yyyy HH:mm')}}
        </div>
        <div *ngIf="conversationWrapper.messageWrapper.unread" class="mt-4 unread-message-count accent">{{conversationWrapper.messageWrapper.unread}}</div>
      </div>

    </div>

  </div>

</button>
